<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!-- TODO: Hide Tax and Delivery from all relevant pages if 0 -->

        <!-- Load custom js -->
        <template id="assets_frontend" inherit_id="website.assets_frontend" name="Shop Donate">
            <xpath expr="." position="inside">
                <link rel="stylesheet" href='/website_sale_donate/static/src/css/website_sale_donate.css' t-ignore="true"/>
                <!-- INFO: jquery validate is loaded in website_tools -->
                <script type="text/javascript" src="/website_sale_donate/static/src/js/website_sale_product_price_form_validate.js"></script>
                <!-- DISABLED just prepared: <script type="text/javascript" src="/website_sale_donate/static/src/js/website_sale_contact_form_validate.js"></script> -->
            </xpath>
        </template>

        <!-- SHOP PRODUCT LISTING: Hide Product Price for Grid and List View if field hide_price set -->
        <template id="wsd_products_item" inherit_id="website_sale.products_item" name="Product Item Extensions">
            <xpath expr="//div[contains(concat(' ', normalize-space(@class), ' '), ' product_price ')]" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'product_price hidden' if product.hide_price else 'product_price text-primary'</attribute>
            </xpath>
            <xpath expr="//section" position="attributes">
                <attribute name="t-att-style">'padding: 0 10px 0 10px' if product.hide_price else ''</attribute>
            </xpath>
        </template>

        <!-- SHOP PRODUCT LISTING: Use Square Images -->
        <template id="wsd_products_item_image" inherit_id="website_sale.products_item" name="Square Images" customize_show="True" active="False">
            <xpath expr="//div[@class='oe_product_image']/a/img[@itemprop='image']" position="replace">
                <img itemprop="image" class="img img-responsive" t-att-src="website.image_url(product, 'image_square')"/>
            </xpath>
        </template>

        <!-- INHERIT SUB-TEMPLATE total: Hide Tax if 0 -->
        <template id="wsd_total" inherit_id="website_sale.total">
            <xpath expr="//tr[@id='order_total_taxes']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'text-muted' if website_sale_order.amount_tax else 'text-muted hidden'</attribute>
            </xpath>
        </template>

        <!-- INHERIT SUB-TEMPLATE total: Hide Delivery if 0 -->
        <template id="wsd_total_delivery" inherit_id="website_sale_delivery.cart_delivery">
            <xpath expr="//tr[@id='order_delivery']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'text-muted' if website_sale_order.amount_delivery else 'text-muted hidden'</attribute>
            </xpath>
        </template>

        <!-- SUB-TEMPLATE: Small Cart Header -->
        <template id="small_cart_header" name="Small Cart Header">
          <h3 class="small_cart_header">
              <a href="/shop/cart">
                  <i class="fa fa-shopping-cart"></i>My Items <small class="text-danger">(change)</small>

              </a>
          </h3>
        </template>

        <!-- SUB-TEMPLATE: Small Cart -->
        <template id="small_cart" name="Shopping Cart Small">

            <div class="small_cart">
              <table class='table table-striped table-condensed' id="cart_products" t-if="website_sale_order and website_sale_order.website_order_line">
                  <thead>
                      <tr>
                          <th colspan="2">Item</th>
                          <th>Price</th>
                      </tr>
                  </thead>
                  <tbody>
                    <t t-foreach="website_sale_order.website_order_line" t-as="line">
                      <tr>
                          <td colspan="2" t-if="not line.product_id.product_tmpl_id"></td>
                          <td align="center" t-if="line.product_id.product_tmpl_id">
                              <span t-field="line.product_id.image_square"
                                    t-field-options='{"widget": "image", "class": "img-rounded"}'/>
                          </td>
                          <td class="text-left" t-if="line.product_id.product_tmpl_id">
                              <div>
                                  <small class="text-muted" t-raw="'{0:,.0f}'.format(int(line.product_uos_qty))"/>
                                  <small class="text-muted"> x </small>
                                  <t t-if="line.payment_interval_id"><small class="text-muted">(<t t-esc="line.payment_interval_id.name"/>)</small></t>
                                  <!--<span t-raw="formatLang(line.product_uos_qty, digit=0)"/> x-->
                                  <a t-attf-href="/shop/product/#{ slug(line.product_id.product_tmpl_id) }">
                                      <strong t-esc="line.product_id.with_context(display_default_code=False).display_name"/>
                                  </a>
                              </div>
                          </td>
                          <td class="text-right" name="price">
                            <span t-field="line.price_unit" style="white-space: nowrap;" t-field-options='{
                                 "widget": "monetary",
                                 "from_currency": "website_sale_order.pricelist_id.currency_id",
                                 "display_currency": "user_id.partner_id.property_product_pricelist.currency_id"
                             }'/>
                          </td>
                      </tr>
                    </t>
                  </tbody>
              </table>
              <t t-call="website_sale.total"/>
              <div class="clearfix"/>
            </div>
        </template>

        <!-- SHOP PRODUCT LISTING: small cart on left side -->
        <template id="products_cart" inherit_id="website_sale.products" active="False" customize_show="True" name="Product Cart">
          <xpath expr="//div[@id='products_grid_before']" position="inside">
              <t t-set="website_sale_order" t-value="website.sale_get_order()"/>

              <!-- Small Cart Header -->
              <ul class="nav nav-pills nav-stacked mb8">
                  <li t-att-class="'' if website_sale_order and website_sale_order.cart_quantity else 'hidden'">
                      <t t-call="website_sale_donate.small_cart_header"/>
                  </li>
              </ul>

              <!-- Small Cart -->
              <t t-call="website_sale_donate.small_cart"/>

              <!-- Checkout Button -->
              <div class="text-left">
                  <a t-if="not optional_products and website_sale_order and website_sale_order.website_order_line" class="btn btn-primary pull-right mb32" href="/shop/cart">Checkout</a>
              </div>
              <div class="clearfix"/>

          </xpath>
            <!-- ATTENTION this will also be done by the product categories: Test what happens if we use both -->
          <xpath expr="//div[@id='products_grid_before']" position="attributes">
              <attribute name="class">col-md-3</attribute>
          </xpath>
          <xpath expr="//div[@id='products_grid']" position="attributes">
              <attribute name="class">col-md-9</attribute>
          </xpath>
            <!-- ToDo: Add a Warenkorb Button to the top of the product grid only visible for in extra small mode
                       This is needed because the left column may disaper in extra small depending on the load order
                       of the templates :(
            -->
        </template>


        <!-- SUB-TEMPLATE: CROWDFUNDING text block -->
        <template id="funding_text" name="Funding Text">
            <span>Help</span>
            <!--<t t-if="product.funding_user"> <t t-esc="product.funding_user.name"/></t>-->
            <t t-if="product.funding_user"> <span t-esc="product.funding_user_name"/> </t>
            <span> to fund </span>
            <span t-field="product.funding_goal" class="text-primary"
                t-field-options='{
                  "widget": "monetary",
                  "from_currency": "product.company_id.currency_id",
                  "display_currency": "user_id.partner_id.property_product_pricelist.currency_id"
               }'/>
            <span> for this project!</span>
        </template>

        <!-- SUB-TEMPLATE: CROWDFUNDING info bar -->
        <template id="funding_bar" name="Funding Bar">
            <div class="progress funding_progress_bar">
                <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" t-att-aria-valuenow="product.funding_reached" aria-valuemin="0" aria-valuemax="100" t-att-style="'width: ' + str(product.funding_reached) + '%;'">
                    <t t-esc="product.funding_reached"/>%
                </div>
            </div>
        </template>


        <!-- SHOP PRODUCT LISTING: Crowd Funding Bar -->
        <template id="wsd_products_item_funding" inherit_id="website_sale.products_item" name="Funding Bar">
            <xpath expr="//div[@class='product_price']" position="after">
                <t t-if="product.funding_goal">
                    <div class="crowdfunding_list_views">
                        <t t-if="not product.hide_fundingtextinlist">
                            <div class="text-info oe_subdescription">
                                <t t-call="website_sale_donate.funding_text"/>
                            </div>
                        </t>
                        <t t-if="not product.hide_fundingbarinlist"><t t-call="website_sale_donate.funding_bar"/></t>
                    </div>
                </t>
            </xpath>
        </template>

        <!-- PRODUCT PAGE: Product Price Sub-Template: -->
        <!-- Hint: product.hide_price has not effect on the product page just on overview pages ! -->
        <template id="wsd_product_price" inherit_id="website_sale.product_price" name="Product-Page Submit-Price-Form Extensions">
            <!-- hide list price if an arbitrary price can be set -->
            <xpath expr="//span[@t-field='product.lst_price']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'text-danger oe_default_price hidden' if product.price_donate else 'text-danger oe_default_price'</attribute>
            </xpath>
            <!-- hide price if an arbitrary price can be set -->
            <xpath expr="//b[@t-field='product.price']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'oe_price text-primary hidden' if product.price_donate else 'oe_price text-primary'</attribute>
            </xpath>
            <!-- Add extra Options to product add to cart form -->
            <xpath expr="//span[@itemprop='price']" position="before">
                <!-- Show an input field to enter the arbitrary price -->
                <t t-if="product.price_donate">
                    <div class="form-group price_donate">
                        <div class="input-group input-group-lg">
                            <span class="input-group-addon" t-esc="user_id.partner_id.property_product_pricelist.currency_id.symbol"/>
                            <label for="price_donate" class="sr-only">Arbitrary Donation</label>
                            <input type="number" class="form-control" name="price_donate" id="price_donate" t-att-min="product.price_donate_min or '1'" t-att-value="price_donate or product.price"/>
                            <span class="input-group-addon" t-esc="user_id.partner_id.property_product_pricelist.currency_id.name"/>
                        </div>
                        <label id="price_donate-error" class="error" for="price_donate" style="font-size: 12px; display: none;"/>
                    </div>
                </t>
                <!-- redirect directly to checkout instead of cart -->
                <t t-if="product.payment_interval_ids">
                    <input type="text" name="simple_checkout" t-att-value="product.simple_checkout" style="display: none;"/>
                </t>
            </xpath>
        </template>

        <!-- PRODUCT PAGE: Product Quantity Sub-Template:
             only show quantity selector if product.hide_quantity not set -->
        <template id="wsd_product_quantity" inherit_id="website_sale.product_quantity" name="Product-Page Quantity Extensions">
            <xpath expr="//div[@class='css_quantity input-group oe_website_spinner']" position="replace">
                <t t-if="not product.hide_quantity">
                    <div class="css_quantity input-group input-group-lg oe_website_spinner">
                        <span class="input-group-addon">
                            <a t-attf-href="#" class="mb8 js_add_cart_json">
                                <i class="fa fa-minus"></i>
                            </a>
                        </span>
                        <input type="text" class="js_quantity form-control" data-min="1" name="add_qty" value="1"/>
                        <span class="input-group-addon">
                            <a t-attf-href="#" class="mb8 float_left js_add_cart_json">
                                <i class="fa fa-plus"></i>
                            </a>
                        </span>
                    </div>
                </t>
            </xpath>
        </template>

        <!-- PRODUCT PAGE: hide add-to-cart form -->
        <template id="wsd_product" inherit_id="website_sale.product" name="Product-Page Hide Payment Box">
            <xpath expr="//form[@class='js_add_cart_variants']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'js_add_cart_variants hidden' if product.hide_payment else 'js_add_cart_variants'</attribute>
            </xpath>
        </template>

        <!-- PRODUCT PAGE: add CROWDFUNDING block -->
        <template id="wsd_product_funding" inherit_id="website_sale.product" name="Product-Page Funding">
            <xpath expr="//div[@t-field='product.website_description']" position="after">
                <t t-if="product.funding_goal">
                    <section class="container mt8" id="oe_website_sale_donate_funding">
                        <div class="row">
                            <t t-if="not product.hide_fundingtext">
                                <div class="crowdfunding">
                                    <p class="text-muted">We have reached</p>
                                    <h1 class="text-primary"><t t-esc="product.funding_reached"/>%</h1>
                                    <p class="text-muted">
                                        <t t-call="website_sale_donate.funding_text"/>
                                    </p>
                                </div>
                            </t>
                            <t t-if="not product.hide_fundingbar"><t t-call="website_sale_donate.funding_bar"/></t>
                            <t t-if="not product.hide_fundingdesc">
                                <div t-field="product.funding_desc" class="oe_structure mt16" id="product_funding_description"/>
                            </t>
                        </div>
                    </section>
                </t>
            </xpath>
        </template>


        <!-- PRODUCT PAGE: replace the original layout with a donation friendly one -->
        <template id="wsd_alternate_product_page" inherit_id="website_sale.product"
                  active="True" customize_show="True" name="Donation Page-Layout" >

            <!-- replace the full shop product page layout - remember to include most of the stuff from the orig. template so that xpath would still work from other addons -->
            <xpath expr="//t[@t-call='website.layout']" position="replace">
                <t t-call="website.layout">
                    <t t-set="additional_title" t-value="product.name"/>
                    <div itemscope="itemscope" itemtype="http://schema.org/Product" id="wrap" class="js_sale">

                        <section id="website_sale_donate"
                                 t-att-class="'parallax oe_img_bg' if product.parallax_image else ''"
                                 t-att-style="'background-image: url(' + website.image_url(product, 'parallax_image') + ');' if product.parallax_image else 'None'"
                                 t-att-data-scroll-background-offset="'0.6' if product.parallax_speed == 'slow' else 0"
                                 data-scroll-background-ratio="0">
                            <div class="row">
                                <div class="col-sm-16">
                                    <section t-attf-class="container mt8 oe_website_sale #{(compute_currency(product.lst_price) - product.price) &gt; 0.1 and 'discount'}" id="product_detail">

                                        <!-- Kategories, Search and Publish Button -->
                                        <div class="row">
                                            <div class="col-sm-4" t-if="not product.hide_categories">
                                                <ol class="breadcrumb">
                                                    <li>
                                                      <t t-if="request.session['last_shop_page']">
                                                          <a t-att-href="request.session['last_shop_page']">Back</a>
                                                      </t>
                                                      <t t-if="not request.session['last_shop_page']">
                                                          <a href="/" onclick="history.go(-1); return false;">Back</a>
                                                      </t>
                                                    </li>
                                                    <li t-if="category"><a t-att-href="keep('/shop/category/%s' % slug(category), category=0)" t-field="category.name"/></li>
                                                    <li class="active"><span t-field="product.name"/></li>
                                                </ol>
                                            </div>
                                            <div class="col-sm-3" t-if="not product.hide_search">
                                              <t t-call="website_sale.search"><t t-set="search_class">pull-right</t></t>
                                            </div>
                                            <div class="col-sm-4" groups="base.group_sale_manager">
                                                <t t-call="website.publish_management">
                                                  <t t-set="object" t-value="product"/>
                                                  <t t-set="publish_edit" t-value="True"/>
                                                  <t t-set="action" t-value="'product.product_template_action'"/>
                                                </t>
                                            </div>
                                        </div>

                                       <!-- Show Warnings -->
                                        <t t-if="warnings">
                                            <div class="row">
                                                <div class="col-sm-16">
                                                    <div t-esc="warnings" class="alert alert-danger" role="alert"/>
                                                </div>
                                            </div>
                                        </t>

                                        <!-- Top HTML Description -->
                                        <t t-if="product.show_desctop">
                                            <div class="row">
                                                <div class="col-sm-16">
                                                    <div t-field="product.desc_short_top" class="oe_structure" id="product_desc_short_top"/>
                                                </div>
                                            </div>
                                        </t>

                                        <!-- Add to cart panel -->
                                        <div class="row">

                                            <!-- (Left) HTML Short Description -->
                                            <div class="col-sm-7 col-md-7 col-lg-6">
                                                <div t-field="product.desc_short" class="oe_structure" id="product_desc_short"/>
                                            </div>

                                            <!-- (Right) add to cart panel -->
                                            <div class="col-sm-5 col-md-5 col-lg-5 col-lg-offset-1" id="wsd-checkout-box">
                                                <div class="panel panel-default">
                                                    <div class="panel-body text-center">

                                                        <!-- Product Name -->
                                                        <h1 itemprop="name" class="mt8 text-muted" t-field="product.name">Product Name</h1>
                                                        <span itemprop="url" style="display:none;" t-esc="'/shop/product/%s' % slug(product)"/>

                                                        <!-- Product Image -->
                                                        <t t-if="not product.hide_image"><p t-field="product.image_square" t-field-options='{"widget": "image", "class": "img-circle"}'/></t>

                                                        <!-- Product Sales Text -->
                                                        <t t-if="product.description_sale and not product.hide_salesdesc">
                                                            <div id="description_sale">
                                                                <p t-field="product.description_sale" class="text-muted"/>
                                                            </div>
                                                        </t>

                                                        <!-- Crowd Funding Info -->
                                                        <t t-if="product.funding_goal">
                                                            <div class="crowdfunding">
                                                                <t t-if="not product.hide_fundingtextincp">
                                                                    <p class="text-muted">We have reached</p>
                                                                    <h1 class="text-primary"><t t-esc="product.funding_reached"/>%</h1>
                                                                    <p class="text-muted">
                                                                        <t t-call="website_sale_donate.funding_text"/>
                                                                    </p>
                                                                </t>
                                                                <t t-if="not product.hide_fundingbarincp"><t t-call="website_sale_donate.funding_bar"/></t>
                                                            </div>
                                                        </t>

                                                        <form t-att-action="keep('/shop/cart/update')" class="js_add_cart_variants" method="POST">
                                                            <div class="js_product">

                                                                <!-- Product Variants -->
                                                                <t t-placeholder="select">
                                                                    <input type="hidden" class="product_id" name="product_id"
                                                                           t-att-value="int(product.product_variant_ids[0]) if len(product.product_variant_ids) == 1 else '0'"/>
                                                                    <t t-call="website_sale.variants">
                                                                        <t t-set="ul_class" t-value="'nav-stacked'"/>
                                                                    </t>
                                                                </t>

                                                                <!-- Price and Not available message -->
                                                                <t t-call="website_sale.product_price"/>
                                                                <p t-if="len(product.product_variant_ids) > 1"
                                                                   class="css_not_available_msg bg-danger"
                                                                   style="padding: 15px;">Product not available
                                                                </p>

                                                                <!-- Show Warnings -->
                                                                <t t-if="warnings">
                                                                    <div t-esc="warnings" class="alert alert-danger" role="alert"/>
                                                                </t>

                                                                <!-- Add to Cart Button -->
                                                                <a id="add_to_cart" class="btn btn-primary btn-xl mt16 js_check_product a-submit" href="#">
                                                                    <t t-if="product.simple_checkout">Donate Now!</t>
                                                                    <t t-if="not product.simple_checkout">Add to Cart</t>
                                                                </a>

                                                                <!-- payment interval radio boxes -->
                                                                <t t-if="product.payment_interval_ids">
                                                                    <h4 class="text-left" style="padding: 0 1em;">
                                                                        <hr style="margin: 0; margin-top: 1.5em;" />
                                                                        <small class="text-muted">How frequent would you like to donate this amount:</small>
                                                                        <div class="form-group text-left">
                                                                            <div class="radio" t-foreach="product.payment_interval_ids" t-as="payint">
                                                                                <label>
                                                                                    <input type="radio" name="payment_interval_id"  t-att-value="payint.id" t-att-checked="'checked' if payint.id == payment_interval_id else ''"/>
                                                                                    <t t-esc="payint.name"/>
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </h4>
                                                                </t>

                                                            </div>
                                                        </form>
                                                    </div>

                                                    <div class="panel-footer" t-if="not product.hide_panelfooter">
                                                        <p class="text-muted">
                                                            30-day money-back guarantee
                                                            <br/>
                                                            Free Shipping in U.S.
                                                            <br/>
                                                            Buy now, get in 2 days
                                                        </p>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bottom HTML Description -->
                                        <t t-if="product.show_descbottom">
                                            <div class="row">
                                                <div class="col-sm-16">
                                                    <div t-field="product.desc_short_bottom" class="oe_structure" id="product_desc_short_bottom"/>
                                                </div>
                                            </div>
                                        </t>
                                    </section>
                                </div>
                            </div>
                        </section>

                        <!-- Product HTML Description -->
                        <section>
                            <div class="row">
                                <div itemprop="description" t-field="product.website_description" class="oe_structure" id="product_full_description"/>
                            </div>
                        </section>

                    </div>
                </t>
            </xpath>

        </template>

        <!-- DONATION PRODUCT PAGE: show shopping cart -->
        <template id="wsd_product_small_cart" inherit_id="website_sale_donate.wsd_alternate_product_page" name="Show Cart" customize_show="True" active="False">
            <xpath expr="//t[@t-if='product.payment_interval_ids']" position="after">
                <t t-set="website_sale_order" t-value="website.sale_get_order()"/>
                <t t-if="website_sale_order and website_sale_order.website_order_line">
                    <!-- Small Cart Header -->
                    <t t-call="website_sale_donate.small_cart_header"/>

                    <!-- Small Cart -->
                    <t t-call="website_sale_donate.small_cart"/>

                    <!-- Back and Forward Buttons -->
                    <div class="text-left">
                          <t t-if="request.session['last_shop_page']">
                              <a t-att-href="request.session['last_shop_page']" class="btn btn-default">Back</a>
                          </t>
                          <t t-if="not request.session['last_shop_page']">
                              <a href="/" onclick="history.go(-1); return false;" class="btn btn-default">Back</a>
                          </t>
                          <a t-if="not optional_products and website_sale_order and website_sale_order.website_order_line" class="btn btn-primary pull-right mb32" href="/shop/cart">Checkout</a>
                    </div>
                    <div class="clearfix"/>
                </t>
            </xpath>
        </template>


        <!-- SHOPPING CART: payment interval, quantity controls -->
        <template id="wsd_cart_extended" inherit_id="website_sale.cart" name="Product-Cart Extensions">
            <!-- Add payment interval as text under the product price -->
            <xpath expr="//table[@id='cart_products']//td[@name='price']" position="inside">
                <t t-if="line.payment_interval_id">
                    <div class="small">(<t t-esc="line.payment_interval_id.name"/>)</div>
                </t>
            </xpath>
            <!-- Do not show Sales order line text in shopping cart! (Because of two bugs: Bug 1: False if none Bug2: english language) -->
            <xpath expr="//table[@id='cart_products']//div[@class='text-muted']" position="replace">
                    <div class="hidden"></div>
                    <!--<t t-if="'\n'.join(line.name.splitlines()[1:]) != 'False'">-->
                        <!--<div class="text-muted" t-esc="'\n'.join(line.name.splitlines()[1:])"/>-->
                    <!--</t>-->
            </xpath>
            <!-- Change the product quantity controls (oe_website_spinner) to only show "-" if hide_quantity set -->
            <xpath expr="//table[@id='cart_products']//div[@class='input-group oe_website_spinner']" position="replace">
                <div class="input-group oe_website_spinner">
                  <span class="input-group-addon" t-att-style="'width: 100%; padding: 9px 12px 9px 36px;' if line.product_id.hide_quantity else ''">
                      <a t-attf-href="#" class="mb8 js_add_cart_json" data-no-instant="">
                          <i class="fa fa-minus"></i>
                      </a>
                  </span>
                  <input type="text"
                      t-att-class="'js_quantity form-control' if line.product_id.hide_quantity == False else 'hidden js_quantity form-control'"
                      t-att-data-line-id="line.id"
                      t-att-data-product-id="line.product_id.id"
                      t-att-value="int(line.product_uom_qty)"/>
                  <span class="input-group-addon">
                      <a t-attf-href="#"
                         t-att-class="'mb8 float_left js_add_cart_json' if line.product_id.hide_quantity == False else 'hidden mb8 float_left js_add_cart_json'"
                         data-no-instant="">
                          <i class="fa fa-plus"></i>
                      </a>
                  </span>
                </div>
            </xpath>
            <!-- Hide list price in shopping cart if price_donate true WARNING XPATH NOT WORKING IN PRODUCTIONS SERVERS ?!?
            <xpath expr="//del[@t-field='line.product_id.lst_price']" position="attributes">
                <attribute name="class"></attribute>
                <attribute name="t-att-class">'text-danger hidden' if line.product_id.price_donate else 'text-danger'</attribute>
            </xpath>
            -->
        </template>

        <!-- SHOPPING CART: Better Back Button -->
        <template id="wsd_continue_shopping" inherit_id="website_sale.continue_shopping" customize_show="True" active="True" name="Back_to_Shop Button">
            <xpath expr="//a[@href='/shop']" position="replace">
                <!-- Back Button -->
                <t t-if="request.session['last_page']">
                    <a id="back_to_shop" t-att-href="request.session['last_page']" class="btn btn-default">Back</a>
                </t>
                <t t-if="not request.session['last_page']">
                    <a id="back_to_page" href="/" class="btn btn-default">Back</a>
                </t>
            </xpath>
        </template>


        <!-- CHECKOUT: honor the mandatory fields AND hide Tax and Total -->
        <template id="wsd_checkout" inherit_id="website_sale.checkout" name="Checkout Manadtory Fields">
            <!-- BILLING -->
            <xpath expr="//label[@for='contact_name']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.email_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='street2']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.street2_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='city']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.city_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='country_id']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.country_id_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='phone']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.phone_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='street']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.street_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>

            <xpath expr="//label[@for='state_id']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.state_id_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>

            <xpath expr="//label[@for='vat']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.vat_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='zip']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.zip_mandatory_bill else 'font-weight: normal'</attribute>
            </xpath>
            <!-- SHIPPING -->
            <xpath expr="//label[@for='shipping_phone']" position="attributes">
                <attribute name="t-att-style">'' if website.phone_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='shipping_street']" position="attributes">
                <attribute name="t-att-style">'' if website.street_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='shipping_city']" position="attributes">
                <attribute name="t-att-style">'' if website.city_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='shipping_zip']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.zip_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>
            <xpath expr="//label[@for='shipping_country_id']" position="attributes">
                <attribute name="t-att-style">'' if website.country_id_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>

            <!-- Set default Country if not already selected -->
            <xpath expr="//option[@t-att-value='country.id']" position="replace">
                <!--<attribute name="t-att-selected">'True' if country.id == checkout.get('country_id') or (country.id != checkout.get('country_id') and country.code == 'AT')</attribute>-->
                <option t-att-value="country.id" t-att-selected="'True' if (country.id == checkout.get('country_id') or (country.id != checkout.get('country_id') and country.code == website.country_default_value.code)) else ''"><t t-esc="country.name"/></option>
            </xpath>

            <xpath expr="//label[@for='shipping_state_id']" position="attributes">
                <attribute name="style"></attribute>
                <attribute name="t-att-style">'' if website.state_id_mandatory_ship else 'font-weight: normal'</attribute>
            </xpath>

             <!-- Show Small cart on right side -->
            <xpath expr="//div[@class='col-lg-offset-1 col-lg-3 col-md-3 text-muted']" position="replace">
                <div class="col-lg-offset-1 col-lg-3 col-md-3 text-muted">
                    <div class="row">
                        <t t-set="website_sale_order" t-value="website.sale_get_order()"/>
                        <t t-call="website_sale_donate.small_cart_header"/>
                        <t t-call="website_sale_donate.small_cart" />
                    </div>
                </div>
            </xpath>
        </template>


        <!-- CONFIRMATION: Headline appears on separate line -->
        <template id="wsd_product_item" inherit_id="website_sale.confirmation" name="Confirmation Free Heading">
            <xpath expr="//ul[@class='wizard pull-right']" position="after">
                <div class="clearfix mb32"></div>
            </xpath>
        </template>

        <!-- WEBSITE CUSTOM OPTION: PAYMENT: Hide Delivery Selector -->
        <template id="hide_delivery_selector" inherit_id="website_sale_delivery.payment_delivery" active="True" customize_show="True" name="Hide Delivery Selector">
            <xpath expr="//div[@id='delivery_carrier']" position="attributes">
                <attribute name="class">hidden</attribute>
            </xpath>
        </template>

        <!-- WEBSITE CUSTOM OPTION: CHECKOUT: Hide Shipping Address Selector -->
        <template id="hide_shipping_address" inherit_id="website_sale.checkout" active="True" customize_show="True" name="Hide Shipping Address">
            <xpath expr="//div[@class='form-group col-lg-12']" position="attributes">
                <attribute name="class">form-group col-lg-12 hidden</attribute>
            </xpath>
            <xpath expr="//div[@class='js_shipping row mb16']" position="attributes">
                <attribute name="class">js_shipping row mb16 hidden</attribute>
            </xpath>
        </template>

        <!-- WEBSITE CUSTOM OPTION: PAYMENT: Hide Shipping address at right column -->
        <template id="hide_shipping_address_payment" inherit_id="website_sale.payment" active="True" customize_show="True" name="Hide Shipping Address">
            <xpath expr="//div[@id='right_column']//t" position="replace">
                <div></div>
            </xpath>
        </template>

        <!-- PAYMENT: Hide Acquirer with recurring_transactions=False if -->
        <template id="hide_acquierer_if_no_recurring" inherit_id="website_sale.payment" name="Hide Acquirers if not enabled for recurring transactions">

            <!-- Add payment interval as text under the product price -->
            <xpath expr="//table[@id='cart_products']//span[@t-field='line.price_unit']" position="after">
                <t t-if="line.payment_interval_id">
                    <div class="small">(<t t-esc="line.payment_interval_id.name"/>)</div>
                </t>
            </xpath>

            <!-- Only show correct Acquirers -->
            <xpath expr="//label[@t-if='acquirer.button']" position="attributes">
                <attribute name="t-if">acquirer.button and ((website_sale_order.has_recurring and acquirer.recurring_transactions) or (not website_sale_order.has_recurring))</attribute>
            </xpath>

            <!-- Add the custom image if available -->
            <xpath expr="//img[@class='media-object']" position="attributes">
                <attribute name="t-if">not acquirer.acquirer_icon</attribute>
            </xpath>
            <xpath expr="//img[@class='media-object']" position="after">
                <t t-if="acquirer.acquirer_icon">
                    <span  t-field="acquirer.acquirer_icon" t-field-options='{"widget": "image", "class": "media-object", "style": "max-width: 200px; display: inline-block;"}'/>
                </t>
            </xpath>

        </template>


    </data>
</openerp>
