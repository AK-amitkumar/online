<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <!-- SUBTEMPLATE: Category Descriptions at TOP (Snipped dropping Areas) -->
    <template id="categories_description_text" name="Category Description at Top">
        <!-- Description for Category AND BELOW! -->
        <t t-if="c.id == int(category) or c.cat_desc_showatchilds">
            <!-- Show Info-Box (for logged in users only) -->
            <t groups="base.group_website_publisher">
                <section contenteditable="false">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert" style="padding: 3px 0;">Description for category <b><t t-raw="c.name"/></b> and below! (Will show up on subcategories!):</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
            <t t-if="c.id == int(category)">
               <div t-field="c.cat_desc_showatchilds" class="oe_structure cat_desc_showatchilds"/>
            </t>
            <t t-if="c.id != int(category)">
               <div t-raw="c.cat_desc_showatchilds" class="oe_structure cat_desc_showatchilds" contenteditable="false"/>
            </t>
        </t>

        <!-- Description for Category ONLY! -->
        <t t-if="c.id == int(category)">
            <t groups="base.group_website_publisher">
                <section contenteditable="false">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert" style="padding: 3px 0;">Description for category <b><t t-raw="c.name"/></b> only! (Only shown here!):</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
            <div t-field="c.cat_desc" class="oe_structure cat_desc"/>
        </t>

    </template>

    <!-- SUBTEMPLATE: Category Descriptions at BOTTOM (Snipped dropping Areas) -->
    <template id="categories_description_text_bottom" name="Category Description at Bottom">
        <!-- Description for Category ONLY! -->
        <t t-if="c.id == int(category)">
            <t groups="base.group_website_publisher">
                <section contenteditable="false">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert" style="padding: 3px 0;">Description for category <b><t t-raw="c.name"/></b> only! (Only shown here!):</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
            <div t-field="c.cat_descbottom" class="oe_structure cat_descbottom"/>
        </t>

        <!-- Description for Category AND BELOW! -->
        <t t-if="c.id == int(category) or c.cat_descbottom_showatchilds">
            <!-- Show Info-Box (for logged in users only) -->
            <t groups="base.group_website_publisher">
                <section contenteditable="false">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert" style="padding: 3px 0;">Description for category <b><t t-raw="c.name"/></b> and below! (Will show up on subcategories!):</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
            <t t-if="c.id == int(category)">
               <div t-field="c.cat_descbottom_showatchilds" class="oe_structure cat_descbottom_showatchilds"/>
            </t>
            <t t-if="c.id != int(category)">
               <div t-raw="c.cat_descbottom_showatchilds" class="oe_structure cat_descbottom_showatchilds" contenteditable="false"/>
            </t>
        </t>

    </template>

    <!-- SUBTEMPLATE: RECURSIVE Category Descriptions at TOP -->
    <!-- HINT: Calls itself until no more parent categories are left -->
    <template id="categories_recursive_description" name="Category Description at Top">
        <t t-foreach="c.parent_id" t-as="c">
            <t t-call="website_sale_categories.categories_recursive_description"/>
            <t t-call="website_sale_categories.categories_description_text"/>
        </t>
    </template>

    <!-- SUBTEMPLATE: RECURSIVE Category Descriptions at BOTTOM -->
    <!-- HINT: Calls itself until no more parent categories are left -->
    <template id="categories_recursive_description_bottom" name="Category Description at Bottom">
        <t t-call="website_sale_categories.categories_description_text_bottom"/>
        <t t-foreach="c.parent_id" t-as="c">
            <t t-call="website_sale_categories.categories_recursive_description_bottom"/>
        </t>
    </template>


    <!-- SUBTEMPLATE: Recursive Category Navigation for Trees WITHOUT a root category set -->
    <template id="categories_recursive_extended" name="Category list">
      <li t-att-class="'active cat%s' % int(c.id or 0) if c.id == int(category or 0) else 'cat%s' % int(c.id or 0)">
          <a t-att-href="keep('/shop/category/' + slug(c), category=0)" t-field="c.name"></a>
          <!-- Render child categories if any -->
          <ul t-if="c.child_id" class="nav nav-pills nav-stacked nav-hierarchy">
              <t t-foreach="c.child_id" t-as="c">
                  <!-- Render the category if the category ist not a rootcat or its rootcat is the category itself -->
                  <t t-if="((c.id == rootcat) or (c.cat_root == False)) and (not c.cat_hide)">
                    <t t-call="website_sale_categories.categories_recursive_extended"/>
                  </t>
              </t>
          </ul>
      </li>
    </template>


    <!-- TEMPLATE: ADVANCED CATEGORY NAVIGATION and TOP AND BOTTOM CATEGORY DESCRIPTIONS -->
    <template id="products_categories_menu" inherit_id="website_sale.products" active="True" customize_show="True" name="Product Categories Advanced">

        <!-- ADVANCED CATEGORY NAVIGATION -->
        <xpath expr="//div[@id='products_grid_before']" position="inside">

            <!-- Check the current category: set cat_hide and hasrootcat
                 HINT: This is needed since category could be empty (cat0 = All Products)
            -->
            <t t-set="start_categories" t-value="categories"/>
            <t t-set="cat_hide" t-value="False" />
            <t t-set="rootcat" t-value="False"/>

            <t t-if="category">
                <t t-set="cat_hide" t-value="category.cat_hide"/>
                <t t-if="category.cat_root_id.cat_root">
                    <t t-set="start_categories" t-value="category.cat_root_id"/>
                    <t t-set="rootcat" t-value="category.cat_root_id.id"/>
                </t>
            </t>

            <t t-if="not cat_hide">
                <ul class="cat_menu nav nav-pills nav-stacked">
                    <!-- Show "All Products" link if the current category has no root category -->
                    <t t-if="rootcat == False">
                        <li t-att-class=" 'cat0' if category else 'active cat0' "><a t-att-href="keep('/shop',category=0)">All Products</a></li>
                    </t>
                    <!-- Render categories if any -->
                    <t t-foreach="start_categories" t-as="c">
                        <!-- Render the category if the category ist not a rootcat or its rootcat is the category itself -->
                        <t t-if="((c.id == rootcat) or (c.cat_root == False)) and (not c.cat_hide)">
                            <t t-call="website_sale_categories.categories_recursive_extended"/>
                        </t>
                    </t>
                </ul>
            </t>

        </xpath>

        <!-- Categories Advanced Navigation left column -->
        <xpath expr="//div[@id='products_grid_before']" position="attributes">
            <attribute name="class"></attribute>
            <attribute name="t-att-class">'hidden' if cat_hide else 'col-md-3 hidden-xs'</attribute>
        </xpath>

        <!-- Categories Advanced Navigation right column -->
        <xpath expr="//div[@id='products_grid']" position="attributes">
            <attribute name="class"></attribute>
            <attribute name="t-att-class">'col-md-12' if cat_hide else 'col-md-9'</attribute>
        </xpath>

        <!-- TOP AND BOTTOM CATEGORY DESCRIPTIONS -->

        <!-- Category Descriptions at TOP -->
        <xpath expr="//div[@id='wrap']/div[@class='oe_structure']" position="before">
            <t groups="base.group_website_publisher">
                <section contenteditable="False">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert"><b>ATTENTION:</b> Content below here is shown on <b>EVERY</b> shop page:</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
        </xpath>
        <xpath expr="//div[@id='wrap']/div[@class='oe_structure']" position="after">
            <t t-if="category">
                <!-- Render descriptions for categories above -->
                <t t-foreach="category" t-as="c">
                    <t t-call="website_sale_categories.categories_recursive_description"/>
                </t>
                <!-- Render category description -->
                <t t-foreach="category" t-as="c">
                    <t t-call="website_sale_categories.categories_description_text"/>
                </t>
            </t>
        </xpath>

        <!-- Category Descriptions at BOTTOM -->
        <xpath expr="//div[@id='wrap']/div[@class='oe_structure mb32']" position="before">
            <t t-if="category">
                <!-- Render descriptions for categories above -->
                <t t-foreach="category" t-as="c">
                    <t t-call="website_sale_categories.categories_recursive_description_bottom"/>
                </t>
            </t>
            <t groups="base.group_website_publisher">
                <section contenteditable="False">
                    <div class="container">
                        <div class="row" >
                            <div class="col-md-12">
                                <div class="alert alert-info text-center" role="alert"><b>ATTENTION:</b> Content below here is shown on <b>EVERY</b> shop page:</div>
                            </div>
                        </div>
                    </div>
                </section>
            </t>
        </xpath>

    </template>

</data>
</openerp>